{{!--
Code Block Component
A reusable Handlebars partial for displaying code with syntax highlighting and copy functionality.

Usage:
Basic: {{> code-block language="javascript" code="const x = 1;" id="unique-id"}}
With filename: {{> code-block language="javascript" filename="server.js" code="..." id="unique-id"}}
With highlight: {{> code-block language="javascript" code="..." id="unique-id" highlightLines="12,13"}}

Parameters:
- language: Programming language for syntax highlighting (e.g., "javascript", "html", "css", "bash")
- code: The actual code content to display
- id: Unique identifier for the code block (used for copy functionality)

Optional Parameters:
- filename: Filename to display in header (shows file icon)
- title: Optional title (used if no filename provided)
- highlightLines: Comma-separated line numbers to highlight (e.g., "3,4,5")
--}}


<div class="code-block-stripe relative rounded-lg overflow-hidden my-4" data-code-block {{#if
    highlightLines}}data-highlight-lines="{{highlightLines}}" {{/if}}>
    {{!-- Header bar with filename and actions --}}
    <div class="code-block-header flex justify-between items-center px-4 py-2">
        {{!-- Left side: File icon and name --}}
        <div class="flex items-center gap-2">
            {{!-- File icon --}}
            <svg class="w-4 h-4 text-muted-foreground" fill="none" viewBox="0 0 24 24" stroke="currentColor"
                stroke-width="1.5">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
            </svg>
            {{!-- Filename or language --}}
            <span class="text-sm text-foreground font-medium">
                {{#if filename}}{{filename}}{{else}}{{#if title}}{{title}}{{else}}{{language}}{{/if}}{{/if}}
            </span>
        </div>

        {{!-- Right side: Language badge and copy button --}}
        <div class="flex items-center gap-3">
            {{!-- Language badge --}}
            <span class="text-xs text-muted-foreground uppercase tracking-wide hidden sm:inline">{{language}}</span>

            {{!-- Copy button --}}
            <button type="button" class="copy-btn flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-md
                       bg-muted hover:bg-accent border border-border hover:border-border
                       text-muted-foreground hover:text-foreground transition-all duration-200 ease-out"
                data-code-target="code-{{id}}" aria-label="Copy code to clipboard">
                {{!-- Default state: Copy icon --}}
                <span class="copy-icon-default flex items-center gap-1.5">
                    <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                    </svg>
                    <span>Copy</span>
                </span>
                {{!-- Copied state --}}
                <span class="copy-icon-success hidden items-center gap-1.5 text-success">
                    <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                    </svg>
                    <span>Copied!</span>
                </span>
            </button>
        </div>
    </div>

    {{!-- Code content with line numbers --}}
    <div class="code-block-content relative overflow-x-auto">
        <pre
            class="code-pre shiki-code !m-0 !bg-transparent"><code id="code-{{id}}" class="shiki-code-inner language-{{language}} !bg-transparent text-sm">{{code}}</code></pre>
    </div>
</div>